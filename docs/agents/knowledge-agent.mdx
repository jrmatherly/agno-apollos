---
title: "Knowledge Agent"
description: "Agentic RAG agent with hybrid search, learning system, and user profiles."
---

The Knowledge Agent answers questions using hybrid search (vector + keyword) over documents stored in PostgreSQL with pgvector. It features intent routing, confidence signaling, a learning system, and per-user profiles.

```python
from agno.agent import Agent
from agno.guardrails import PIIDetectionGuardrail, PromptInjectionGuardrail
from agno.learn import (
    LearnedKnowledgeConfig, LearningMachine, LearningMode,
    UserMemoryConfig, UserProfileConfig,
)

from backend.db import create_knowledge, get_postgres_db
from backend.models import get_model
from backend.tools.search import search_content
from backend.tools.awareness import list_knowledge_sources
from backend.tools.approved_ops import add_knowledge_source

knowledge_agent = Agent(
    id="knowledge-agent",
    name="Knowledge Agent",
    model=get_model(),
    db=get_postgres_db(),
    knowledge=create_knowledge("Knowledge Agent", "knowledge_agent_docs"),
    instructions=instructions,
    tools=[search_content, list_knowledge_sources, add_knowledge_source],
    search_knowledge=True,
    pre_hooks=[PIIDetectionGuardrail(mask_pii=False), PromptInjectionGuardrail()],
    learning=LearningMachine(
        learned_knowledge=LearnedKnowledgeConfig(
            mode=LearningMode.AGENTIC,
            knowledge=knowledge_learnings,
        ),
        user_profile=UserProfileConfig(db=agent_db),
        user_memory=UserMemoryConfig(db=agent_db),
    ),
    enable_agentic_memory=True,
    enable_session_summaries=True,
    markdown=True,
)
```

## Key features

| Feature | Configuration |
|---------|--------------|
| Hybrid search | `search_knowledge=True`, hybrid search on Knowledge |
| Session memory | `db=get_postgres_db()` persists conversations across sessions |
| Guardrails | PII detection and prompt injection via `pre_hooks` |
| Learning | `LearningMachine` saves useful patterns for future queries |
| User profiles | `UserProfileConfig` and `UserMemoryConfig` for per-user context |
| Custom tools | `search_content`, `list_knowledge_sources`, `add_knowledge_source` |
| Intent routing | Routes queries by type (factual, exploratory, comparative) |
| Confidence signaling | Indicates certainty level in responses |
| Session summaries | `enable_session_summaries=True` for conversation persistence |

## Loading documents

The knowledge base must be populated before the agent can answer questions:

```bash
mise run load-docs
```

The agent loads URL-based documents from `docs.agno.com` plus any PDF and CSV files from `data/docs/`.

To add custom documents, place PDF or CSV files in `data/docs/` and re-run `mise run load-docs`.

## Document loaders

The knowledge system supports multiple document formats via `backend/knowledge/loaders.py`:

| Format | Loader | Source |
|--------|--------|--------|
| URL | Built-in `Knowledge.insert()` | Configured in `knowledge_agent.py` |
| PDF | `PDFReader` from `agno.knowledge.reader.pdf_reader` | Files in `data/docs/*.pdf` |
| CSV | `CSVReader` from `agno.knowledge.reader.csv_reader` | Files in `data/docs/*.csv` |

## Approval-gated tools

The `add_knowledge_source` tool uses the `@approval` decorator for human-in-the-loop confirmation before adding new sources. This requires JWT auth to be enabled. See [security configuration](/configuration/security).

## Example queries

```
What is Agno?
How do I create my first agent?
What documents are in your knowledge base?
```
